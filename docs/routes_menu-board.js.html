<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: routes/menu-board.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: routes/menu-board.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Route for displaying and traversing Menu Board
 * @module routes/menu=board
 */

const express = require('express');
const router = express.Router();
const pool = require('../db');
const { auth } = require('./login');

/**
 * GET /menu-board
 * Renders the main menu board view.
 * Implements role-based access control:
 * - Redirects customers to the customer portal
 * - Redirects non-admin users to the login page
 * - Only allows admin users to access the menu board
 * 
 * @name GetMenu-Board
 * @route {GET} /menu-board
 * @authentication Requires authentication via auth middleware
 * @authorization Requires 'admin' role
 * @returns {Redirect} Redirects to /customer if user role is 'customer'
 * @returns {Redirect} Redirects to /login if user role is not 'admin'
 * @returns {View} Renders the universal menu-board for admin users
 */
router.get('/', auth, async (req, res) => {
    if (req.user.role == 'customer') {
        return res.redirect('customer');
    }
    if (req.user.role != 'admin') {
        return res.redirect('login');
    }
    try {
        const priceFunc = require('../public/functions/kiosk/getPrice')(pool);
        const { getPrice } = priceFunc; 
        const price = await getPrice();
        const prices = {};
        price.forEach(row => {
            prices[row.size] = row.price;            
        });
        const appPrice = price.find(p => p.size === "Appetizer")?.price || null;
        const drinkPrice     = price.find(p => p.size === "Drink")?.price || null;
        const entreeFunc = require('../public/functions/kiosk/getEntrees')(pool);
        const { getEntreeNames } = entreeFunc; 
        const entreeNames = await getEntreeNames();
        res.render('menu-board/menu-board', {
            page:'menu-board/menu-board', 
            entreeNames: entreeNames,
            appPrice: appPrice,
            drinkPrice: drinkPrice,
            price: price,
            prices

        });
    } catch (error) {
        console.error("Error retrieving menu items:", error.message);
        res.status(500).send("Failed to load menu items.");
    }
});

/**
 * GET /menu-board/sizes
 * Renders the menu board size view.
 * 
 * @name GetSizes
 * @route {GET} /menu-board/sizes
 * @returns {View} Renders the menu-board's sizes page
 */
router.get('/sizes', async (req, res)  =>{
    try {
        const kioskFunctions = require('../public/functions/kiosk/getPrice')(pool);
        const { getPrice } = kioskFunctions; 
        const result = await getPrice();
        const prices = {};
        result.forEach(row => {
            prices[row.size] = row.price;            
        });

        res.render('menu-board/sizes', {
            page:'menu-board/sizes', 
            prices
        });
    } catch (error) {
        console.error("Error retrieving menu items:", error.message);
        res.status(500).send("Failed to load menu items.");
    }
});

/**
 * GET /menu-board/entrees
 * Renders the menu board entree view.
 * 
 * @name GetEntrees
 * @route {GET} /menu-board/entrees
 * @returns {View} Renders the menu-board's entrees page
 */
router.get('/entrees', async (req, res)  =>{
    try {
        const kioskFunctions = require('../public/functions/kiosk/getEntrees')(pool);
        const { getEntreeNames } = kioskFunctions; 
        const entreeNames = await getEntreeNames();


        res.render('menu-board/entrees', {
            page:'menu-board/entrees', 
            entreeNames: entreeNames,

        });
    } catch (error) {
        console.error("Error retrieving menu items:", error.message);
        res.status(500).send("Failed to load menu items.");
    }
});

/**
 * GET /menu-board/sides-and-a-la-carte
 * Renders the menu board size view.
 * 
 * @name GetSidesAndALaCarte
 * @route {GET} /menu-board/sides-and-a-la-carte
 * @returns {View} Renders the menu-board's sides and a la carte page
 */
router.get('/sides-and-a-la-carte', async (req, res)  =>{
    try {
        const kioskFunctions = require('../public/functions/kiosk/getEntrees')(pool);
        const { getEntreeNames } = kioskFunctions; 
        const entreeNames = await getEntreeNames();

        const priceFunctions = require('../public/functions/kiosk/getPrice')(pool);
        const { getPrice } = priceFunctions; 
        const price = await getPrice();
        
        const prices = {};
        
        price.forEach(row => {
            prices[row.size] = row.price;            
        });

        res.render('menu-board/sides-and-a-la-carte', {
            page:'menu-board/sides-and-a-la-carte', 
            entreeNames: entreeNames,
            price: price,
            prices

        });
    } catch (error) {
        console.error("Error retrieving menu items:", error.message);
        res.status(500).send("Failed to load menu items.");
    }
});

/**
 * GET /menu-board/appetizers-and-drinks
 * Renders the menu board appetizers and drinks view.
 * 
 * @name GetAppetizersAndDrinks
 * @route {GET} /menu-board/appetizers-and-drinks
 * @returns {View} Renders the menu-board's appetizers and drinks page
 */
router.get('/appetizers-and-drinks', async (req, res)  =>{
    try {
        const kioskFunctions = require('../public/functions/kiosk/getEntrees')(pool);
        const { getEntreeNames } = kioskFunctions; 
        const entreeNames = await getEntreeNames();

        const priceFunctions = require('../public/functions/kiosk/getPrice')(pool);
        const { getPrice } = priceFunctions; 
        const price = await getPrice();
        const appPrice = price.find(p => p.size === "Appetizer")?.price || null;
        const drinkPrice     = price.find(p => p.size === "Drink")?.price || null;


        res.render('menu-board/appetizers-and-drinks', {
            page:'menu-board/appetizers-and-drinks', 
            entreeNames: entreeNames,
            appPrice: appPrice,
            drinkPrice: drinkPrice,

        });
    } catch (error) {
        console.error("Error retrieving menu items:", error.message);
        res.status(500).send("Failed to load menu items.");
    }
});

module.exports = router;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-API_CurrencyExchange.html">API/CurrencyExchange</a></li><li><a href="module-API_Weather.html">API/Weather</a></li><li><a href="module-routes_kitchen.html">routes/kitchen</a></li><li><a href="module-routes_manager.html">routes/manager</a></li><li><a href="module-routes_managerReportRoute_XandZReport.html">routes/managerReportRoute/XandZReport</a></li><li><a href="module-routes_managerReportRoute_managerReports.html">routes/managerReportRoute/managerReports</a></li><li><a href="module-routes_managerReportRoute_productUsageReport.html">routes/managerReportRoute/productUsageReport</a></li><li><a href="module-routes_managerReportRoute_restockReport.html">routes/managerReportRoute/restockReport</a></li><li><a href="module-routes_managerReportRoute_salesReport.html">routes/managerReportRoute/salesReport</a></li><li><a href="module-routes_managerRoute_employees.html">routes/managerRoute/employees</a></li><li><a href="module-routes_managerRoute_inventory.html">routes/managerRoute/inventory</a></li><li><a href="module-routes_managerRoute_menu.html">routes/managerRoute/menu</a></li><li><a href="module-routes_managerRoute_pricing.html">routes/managerRoute/pricing</a></li><li><a href="module-routes_managerRoute_recipes.html">routes/managerRoute/recipes</a></li><li><a href="module-routes_managerRoute_schedule.html">routes/managerRoute/schedule</a></li><li><a href="module-routes_menu=board.html">routes/menu=board</a></li><li><a href="module-routes_newCashier.html">routes/newCashier</a></li><li><a href="module-routes_prep-table.html">routes/prep-table</a></li></ul><h3>Classes</h3><ul><li><a href="Entry.html">Entry</a></li><li><a href="MenuItem.html">MenuItem</a></li><li><a href="Order.html">Order</a></li><li><a href="TotalOrder.html">TotalOrder</a></li><li><a href="module-routes_newCashier-fullEntry.html">fullEntry</a></li></ul><h3>Global</h3><ul><li><a href="global.html#GetLoginScreen">GetLoginScreen</a></li><li><a href="global.html#GoToManagerReports">GoToManagerReports</a></li><li><a href="global.html#GoToManagerView">GoToManagerView</a></li><li><a href="global.html#GoToProductUsageReport">GoToProductUsageReport</a></li><li><a href="global.html#GoToRestock">GoToRestock</a></li><li><a href="global.html#GoToSalesReport">GoToSalesReport</a></li><li><a href="global.html#GoToXReport">GoToXReport</a></li><li><a href="global.html#GoToZReport">GoToZReport</a></li><li><a href="global.html#PostLoginInfo">PostLoginInfo</a></li><li><a href="global.html#RestockItems">RestockItems</a></li><li><a href="global.html#SetZReportTime">SetZReportTime</a></li><li><a href="global.html#authJWT">authJWT</a></li><li><a href="global.html#calcPrice">calcPrice</a></li><li><a href="global.html#cancelOrder">cancelOrder</a></li><li><a href="global.html#confirmOrder">confirmOrder</a></li><li><a href="global.html#deleteEntry">deleteEntry</a></li><li><a href="global.html#editEntry">editEntry</a></li><li><a href="global.html#entrees">entrees</a></li><li><a href="global.html#getEntreeId">getEntreeId</a></li><li><a href="global.html#goBack">goBack</a></li><li><a href="global.html#limits">limits</a></li><li><a href="global.html#loadSelections">loadSelections</a></li><li><a href="global.html#mealType">mealType</a></li><li><a href="global.html#menuItem">menuItem</a></li><li><a href="global.html#orderMore">orderMore</a></li><li><a href="global.html#pending">pending</a></li><li><a href="global.html#proceed">proceed</a></li><li><a href="global.html#removeNotification">removeNotification</a></li><li><a href="global.html#renderProductUsageChart">renderProductUsageChart</a></li><li><a href="global.html#requestHelp">requestHelp</a></li><li><a href="global.html#selectItem">selectItem</a></li><li><a href="global.html#selectSize">selectSize</a></li><li><a href="global.html#selectedItems">selectedItems</a></li><li><a href="global.html#showPopup">showPopup</a></li><li><a href="global.html#sides">sides</a></li><li><a href="global.html#startOrder">startOrder</a></li><li><a href="global.html#submitCancellation">submitCancellation</a></li><li><a href="global.html#submitOrder">submitOrder</a></li><li><a href="global.html#subs">subs</a></li><li><a href="global.html#validateOrder">validateOrder</a></li><li><a href="global.html#verifyEmployee">verifyEmployee</a></li><li><a href="global.html#viewBag">viewBag</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Wed Dec 10 2025 21:53:57 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
